# Проект Hotdog-or-Not

### кто делал:
Максим Демидов [@lornfluke](https://t.me/lornfluke) - пожалуйста, пишите,
если что-то не так, я на связи.

## Что в проекте:
По сути ничего особенного сверх требований - задача бинарной классификации,
хотдог или нет. В качестве базы взят срез из Food 101,
хотдоги и случайно набранные изображения из других классов.\
Модель основана на Squeezenet v1.1, заменена только голова.
Фиксируются все слои, кроме верхних n, и дообучается на данных.
К сожалению, времени оттюнить модель не было, поэтому просто дефолтный запуск.
Нет аугментаций и данных мало, модель переобучается даже не паре эпох.

Но весь функционал вроде бы реализован - зависимости в poetry, пре-коммит хуки,
предобученная модель сложена на dvc, данные там же. Если их нет в папке проекта
на момент запуска, стягиваются с хранилища.
Хранилищем служет папка в [google drive](https://drive.google.com/drive/folders/1JJCZ0mZa9TuGWcZUturH82_uAUiXF1_i?usp=drive_link)

запуск ожидается из папки проекта:\
`python3.10 train.py` и `python3.10 infer.py`\
Все конфиги в Hydra, можно подставить в качестве аргумента название
весов модели после обучения или файла инференса:\
`python3.10 train.py model_out=<some-other-name>.pt`\
или\
`python3.10 infer.py infer_out=<some-other-name>.csv`

По умолчанию получаем веса модели `trained_model.pt`, и .csv файл с результатом
прогона на тестовой выборке - `output.csv`.

Метрики при обучении отправляются в MLflow по адресу 128.0.1.1:8080, довольно обычные - loss, accuracy, precision, recall
